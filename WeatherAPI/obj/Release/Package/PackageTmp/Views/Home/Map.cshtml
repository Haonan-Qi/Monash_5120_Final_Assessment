<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


    <!--Font CSS-->
    <link href="https://fonts.googleapis.com/css?family=Kalam:700|Kreon:700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Audiowide" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Julius+Sans+One" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">


    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <style>
        /* Always set the map height explicitly to define the size of the div
        * element that contains the map. */
        #map {
            height: 100%;
            margin-right: 400px;
            position: absolute;
            top: 1000;
            right: 0;
            bottom: 0;
            left: 0;
        }
        /* Optional: Makes the sample page fill the window. */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        #floating-panel {
            width: 600px;
            top: 10px;
            height: 55px;
            left: 25%;
            z-index: 5;
            padding: 5px;
            text-align: center;
            line-height: 30px;
            padding-left: 10px;
            font-family: 'Kreon';
        }

        #floating-panel2 {
            top: 50px;
            left: 25%;
            width: 500px;
            height: 55px;
            z-index: 5;
            padding: 5px;
            text-align: center;
            font-family: 'Kreon';
            line-height: 30px;
            padding-left: 10px;
        }

        #right-panel {
            font-family: 'Roboto','sans-serif';
            line-height: 30px;
            padding-left: 10px;
        }

            #right-panel select, #right-panel input {
                font-size: 15px;
            }

            #right-panel select {
                width: 100%;
            }

            #right-panel i {
                font-size: 12px;
            }

        #right-panel {
            height: 500px;
            float: right;
            width: 390px;
            overflow: scroll;
        }

        @@media print {
            #map {
                height: 500px;
                margin: 0;
            }

            #right-panel {
                float: none;
                width: auto;
            }
        }
    </style>
</head>

<body style="background-color: #343a40 !important;height:100vh;background-attachment: scroll;background-image:url(https://images.unsplash.com/photo-1445384763658-0400939829cd?ixlib=rb-0.3.5&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=1080&fit=max&ixid=eyJhcHBfaWQiOjF9&s=7ca46aca5c7817d7ff48b3273e35b119);background-size:cover;background-attachment:fixed">
    <!--导航栏部分-->
    <nav class="navbar navbar-expand-lg navbar-light border-bottom shadow-sm" style="background-color: #f7f8fae6">
        <a class="navbar-brand" href="@Url.Action("Index","Home")" style="font-size: 2rem;font-family: 'Kreon', serif;">Time 2 Go</a>
        <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarsExample09" aria-controls="navbarsExample09" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="navbar-collapse collapse" id="navbarsExample09">
            <ul class="navbar-nav" style="margin-left:auto;font-family: 'Kreon', serif;font-size: x-large;font-weight: 300">
                <ul class="navbar-nav" style="margin-left:auto;font-family: 'Kreon', serif;font-size: x-large;font-weight: 300">
                    <li><a href="@Url.Action("Index","Home")" class="nav-link">Home</a></li>
                    <li><a href="@Url.Action("SportsLocation","Home")" class="nav-link">Sports Location</a></li>
                    <li><a href="@Url.Action("Calories","Home")" class="nav-link">Calories Schedule</a></li>
                    <li><a href="@Url.Action("Events","Home")" class="nav-link">Events</a></li><!--事件相关链接，需要改全部page的导航部分-->
                    <li><a href="@Url.Action("Food","Home")" class="nav-link">Healthy Eating</a></li>
                    <li><a href="@Url.Action("Weather","Home")" class="nav-link">Weather</a></li>
                    <li><a href="@Url.Action("SportsIntroduction","Home")" class="nav-link">Sports Rules</a></li>
                </ul>
            </ul>
        </div>
    </nav>

    <div class="container" style="max-height:80vh;background-color:#f2e2e5b3;margin-top:3vh;border-radius:30px;font-family: 'Kreon';padding-top: 10px;padding-bottom:30px;padding-right:30px;padding-left: 30px;">

        <div class="row">

            <div class="col-6">
                <div id="floating-panel" style="position: static;" class="centered">
                    <b>Mode of Travel: </b>
                    <select id="mode">
                        <option value="TRANSIT">Public Transport</option>
                        <option value="WALKING">Walking</option>
                        <option value="BICYCLING">Bicycling</option>
                        <option value="DRIVING">Driving</option>
                    </select>
                </div>
            </div>

            <div class="col-6">
                <div id="floating-panel2" style="position: static">
                    <b>Your address: </b>
                    <input id="address" type="textbox">
                    <input id="submit" type="button" value="submit">
                </div>
            </div>
        </div>
        <div id="right-panel"></div>

        <div id="map" style="height: 500px;position: relative;"> </div>
    </div>







    <script>
        var sportsLocation = {lat: @ViewBag.latitude, lng: @ViewBag.longtitude }; //to connect data

        function initMap() {

            var directionsDisplay = new google.maps.DirectionsRenderer;
            var directionsService = new google.maps.DirectionsService;
            var infowindow = new google.maps.InfoWindow();
            var geocoder = new google.maps.Geocoder;
            var map = new google.maps.Map(document.getElementById('map'), {
                zoom: 14,
                center: sportsLocation,
            });
            geocodeLatLng(geocoder, map, infowindow);

            directionsDisplay.setMap(map);
            directionsDisplay.setPanel(document.getElementById('right-panel'));

            document.getElementById('submit').addEventListener('click', function () {
                document.getElementById('address');
                document.getElementById('mode');
                calculateAndDisplayRoute(directionsService, directionsDisplay);
            });
        }

        function geocodeLatLng(geocoder, map, infowindow) {

            geocoder.geocode({ 'location': sportsLocation }, function (results, status) {
                if (status === 'OK') {
                    if (results[0]) {
                        map.setZoom(12);
                        var marker = new google.maps.Marker({
                            position: sportsLocation,
                            map: map
                        });
                        infowindow.setContent(results[0].formatted_address);
                        infowindow.open(map, marker);
                    } else {
                        window.alert('No results found');
                    }
                } else {
                    window.alert('Geocoder failed due to: ' + status);
                }
            });
        }


        function calculateAndDisplayRoute(directionsService, directionsDisplay) {
            var selectedMode = document.getElementById('mode').value;
            directionsService.route({
                origin: document.getElementById('address').value,
                destination: sportsLocation,
                // Note that Javascript allows us to access the constant
                // using square brackets and a string value as its
                // "property."
                travelMode: google.maps.TravelMode[selectedMode]
            }, function (response, status) {
                if (status == 'OK') {
                    directionsDisplay.setDirections(response);
                } else {
                    window.alert('Directions request failed due to ADDRESS ' + status);
                }
            });
        }

    </script>

    <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBP3SA4E4fqPbOR3LbDM9-m8MgdCnoNI-k&callback=initMap">
    </script>
</body>

</html>